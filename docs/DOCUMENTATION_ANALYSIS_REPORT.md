# Отчет по анализу документации проекта HomePlanner

**Дата анализа:** 2025-01-XX  
**Аналитик:** AI Assistant  
**Статус:** ✅ Анализ завершен, устаревшие документы перемещены в архив

## Резюме

Проведен анализ всех документов в папке `docs/` на предмет:
- Выполненных миграций
- Дублирования информации
- Несоответствий
- Устаревших документов

## 1. Старые планы миграций

### 1.1. MIGRATION_TO_LOCAL_API.md

**Статус:** ⚠️ План миграции НЕ выполнен, но может быть устаревшим

**Анализ:**
- Документ описывает миграцию с `TasksApiOffline` на `LocalApi`
- ✅ Миграция завершена, `TasksApiOffline` удалён, используется `LocalApi`
- В `OFFLINE_FIRST_ARCHITECTURE.md` упоминается, что `LocalApi` планируется

**Рекомендация:** 
- Если миграция отменена → переместить в архив
- Если миграция запланирована → оставить, но обновить статус

### 1.2. PLAN_OFFLINE_MODE.md

**Статус:** ⚠️ Частично выполнен, содержит устаревшую информацию

**Анализ:**
- Большой план реализации офлайн-режима
- Многие этапы уже реализованы (судя по `OFFLINE_FIRST_ARCHITECTURE.md`)
- Документ ссылается на детальные документы: `OFFLINE_REQUIREMENTS.md`, `OFFLINE_CLIENT_DESIGN.md`, `SYNC_ALGORITHM.md`, `OFFLINE_TEST_PLAN.md`
- Содержит устаревшие детали реализации

**Рекомендация:** 
- Переместить в архив как исторический документ
- Актуальная информация уже вынесена в отдельные документы

### 1.3. PLAN_OFFLINE_MODE_IMPROVEMENTS.md

**Статус:** ✅ Предложения реализованы

**Анализ:**
- Документ содержит предложения по улучшению `PLAN_OFFLINE_MODE.md`
- Предложения включают:
  - Декомпозицию на отдельные документы (✅ выполнено: `OFFLINE_REQUIREMENTS.md`, `OFFLINE_CLIENT_DESIGN.md`, `SYNC_ALGORITHM.md`, `OFFLINE_TEST_PLAN.md`)
  - Канонические правила фильтрации (✅ реализовано в `OFFLINE_REQUIREMENTS.md`)
  - Формальное определение логического дня (✅ реализовано в `OFFLINE_REQUIREMENTS.md`)
  - Архитектура клиента (✅ реализовано в `OFFLINE_CLIENT_DESIGN.md`)

**Рекомендация:** Переместить в архив

### 1.4. OFFLINE_SYNC_PLAN.md

**Статус:** ⚠️ Частично выполнен, содержит устаревшие детали

**Анализ:**
- Детальный план реализации оффлайн-режима
- Многое уже реализовано согласно `OFFLINE_FIRST_ARCHITECTURE.md`
- Содержит детали реализации, которые могут быть устаревшими
- Актуальная информация вынесена в `OFFLINE_FIRST_ARCHITECTURE.md`

**Рекомендация:** Переместить в архив

## 2. Дублирование данных

### 2.1. Правила фильтрации задач

**Дублирование найдено в:**
- `PLAN_OFFLINE_MODE.md` (раздел "Канонические правила фильтрации задач")
- `OFFLINE_REQUIREMENTS.md` (раздел "Канонические правила фильтрации задач")
- `TASKS_FORMAT.md` (раздел "Отображение задач")

**Проблема:** Правила описаны в трех местах с небольшими различиями в формулировках

**Рекомендация:** 
- Оставить каноническую версию в `OFFLINE_REQUIREMENTS.md`
- Обновить ссылки в других документах на `OFFLINE_REQUIREMENTS.md`
- Удалить дублирование из `PLAN_OFFLINE_MODE.md` (после перемещения в архив)

### 2.2. Описание архитектуры офлайн-режима

**Дублирование найдено в:**
- `OFFLINE_FIRST_ARCHITECTURE.md` (актуальная версия)
- `OFFLINE_CLIENT_DESIGN.md` (высокоуровневая архитектура)
- `PLAN_OFFLINE_MODE.md` (устаревшие детали)
- `OFFLINE_SYNC_PLAN.md` (детальный план)

**Проблема:** Архитектура описана в нескольких документах с разной степенью детализации

**Рекомендация:** 
- Оставить `OFFLINE_FIRST_ARCHITECTURE.md` как основной документ
- Оставить `OFFLINE_CLIENT_DESIGN.md` как высокоуровневое описание
- Переместить устаревшие документы в архив

### 2.3. Описание синхронизации

**Дублирование найдено в:**
- `SYNC_ALGORITHM.md` (формальное описание)
- `SYNC_POLICY.md` (политика синхронизации)
- `OFFLINE_SYNC_PLAN.md` (детальный план)
- `OFFLINE_SYNC_NOTES.md` (заметки)
- `knowledge_base/sync_offline_notes.md` (заметки)

**Проблема:** Синхронизация описана в нескольких документах

**Рекомендация:** 
- Оставить `SYNC_ALGORITHM.md` и `SYNC_POLICY.md` как актуальные
- Переместить заметки и устаревшие планы в архив

### 2.4. Описание логического дня

**Дублирование найдено в:**
- `OFFLINE_REQUIREMENTS.md` (формальное определение)
- `OFFLINE_DAY_LOGIC_NOTES.md` (заметки)
- `PLAN_OFFLINE_MODE.md` (устаревшие детали)

**Рекомендация:** 
- Оставить актуальную версию в `OFFLINE_REQUIREMENTS.md`
- Переместить заметки в архив

### 2.5. Описание кэша

**Дублирование найдено в:**
- `OFFLINE_FIRST_ARCHITECTURE.md` (актуальная версия)
- `OFFLINE_CACHE_NOTES.md` (заметки)
- `OFFLINE_SYNC_PLAN.md` (устаревшие детали)

**Рекомендация:** 
- Оставить актуальную версию в `OFFLINE_FIRST_ARCHITECTURE.md`
- Переместить заметки в архив

## 3. Несоответствия

### 3.1. Статус LocalApi

**Несоответствие:**
- `MIGRATION_TO_LOCAL_API.md`: описывает план миграции на `LocalApi`
- `OFFLINE_FIRST_ARCHITECTURE.md`: указывает, что `LocalApi` планируется
- Код: `TasksApiOffline` все еще используется, `LocalApi` не найден

**Проблема:** Неясно, выполняется ли миграция или отменена

**Рекомендация:** 
- Уточнить статус миграции
- Обновить документы соответственно

### 3.2. Версия API в документах

**Несоответствие:**
- `API.md`: упоминает `/api/v0.2/`
- `ARCHITECTURE_vNext.md`: упоминает `/api/v0.2/`
- `VERSIONING.md`: описывает версионирование API
- `PLAN_NETWORK_SETTINGS.md`: упоминает версию API

**Проблема:** Версия API упоминается в разных документах, но может быть несинхронизирована

**Рекомендация:** 
- Проверить актуальность версии API во всех документах
- Использовать единый источник истины (`VERSIONING.md`)

### 3.3. Описание формата задач

**Несоответствие:**
- `TASKS_FORMAT.md`: детальное описание формата
- `API.md`: краткое описание в контексте API
- `OFFLINE_REQUIREMENTS.md`: упоминания формата в контексте офлайн-режима

**Проблема:** Могут быть расхождения в описании формата

**Рекомендация:** 
- Проверить согласованность описаний
- Использовать `TASKS_FORMAT.md` как основной источник

## 4. Устаревшие документы

### 4.1. Заметки (Notes)

**Документы для архива:**
- `OFFLINE_SYNC_NOTES.md` - заметки по синхронизации (информация вынесена в `SYNC_ALGORITHM.md`)
- `OFFLINE_CACHE_NOTES.md` - заметки по кэшу (информация вынесена в `OFFLINE_FIRST_ARCHITECTURE.md`)
- `OFFLINE_DAY_LOGIC_NOTES.md` - заметки по логике дня (информация вынесена в `OFFLINE_REQUIREMENTS.md`)
- `NOTES.md` - общие заметки (PowerShell, pytest и т.д.)

**Рекомендация:** Переместить в архив

### 4.2. Устаревшие планы

**Документы для архива:**
- `PLAN_OFFLINE_MODE.md` - устаревший план (информация вынесена в отдельные документы)
- `PLAN_OFFLINE_MODE_IMPROVEMENTS.md` - предложения реализованы
- `OFFLINE_SYNC_PLAN.md` - устаревший детальный план

**Рекомендация:** Переместить в архив

### 4.3. Knowledge Base

**Документы для архива:**
- `knowledge_base/sync_offline_notes.md` - заметки по синхронизации (информация вынесена в актуальные документы)

**Рекомендация:** Переместить в архив

## 5. Рекомендации по структуре документации

### 5.1. Актуальные документы (оставить)

**Архитектура:**
- `OFFLINE_FIRST_ARCHITECTURE.md` - основная архитектура офлайн-режима
- `OFFLINE_CLIENT_DESIGN.md` - архитектура клиента
- `ARCHITECTURE_vNext.md` - общая архитектура проекта

**Требования и спецификации:**
- `OFFLINE_REQUIREMENTS.md` - требования к офлайн-режиму
- `SYNC_ALGORITHM.md` - алгоритм синхронизации
- `SYNC_POLICY.md` - политика синхронизации
- `TASKS_FORMAT.md` - формат задач
- `API.md` - документация API

**Планы и руководства:**
- `DEVELOPMENT_PLAN_vNext.md` - план разработки
- `DEVELOPMENT.md` - руководство для разработчиков
- `ANDROID_GUIDE.md` - руководство по Android
- `TESTING_CONVENTIONS.md` - конвенции тестирования

**Специфические документы:**
- `MIGRATION_TO_LOCAL_API.md` - план миграции (если актуален)
- `PLAN_NETWORK_SETTINGS.md` - план сетевых настроек
- `LOGGING_FORMAT.md` - формат логирования
- `VERSIONING.md` - версионирование
- `TASK_HISTORY.md` - история задач
- `CHANGELOG_HISTORY.md` - история изменений
- `ARTIFACTS_LAYOUT.md` - расположение артефактов
- `RULES.md` - правила проекта
- `analytics.md` - аналитика

### 5.2. Документы для архива

**Устаревшие планы:**
- `PLAN_OFFLINE_MODE.md`
- `PLAN_OFFLINE_MODE_IMPROVEMENTS.md`
- `OFFLINE_SYNC_PLAN.md`

**Заметки:**
- `OFFLINE_SYNC_NOTES.md`
- `OFFLINE_CACHE_NOTES.md`
- `OFFLINE_DAY_LOGIC_NOTES.md`
- `NOTES.md`
- `knowledge_base/sync_offline_notes.md`

**Планы миграций (если отменены):**
- `MIGRATION_TO_LOCAL_API.md` (если миграция отменена)

## 6. План действий

### Этап 1: Создание архива
- [x] Создать папку `docs/archive/`
- [x] Переместить устаревшие документы в архив
  - [x] `PLAN_OFFLINE_MODE.md`
  - [x] `PLAN_OFFLINE_MODE_IMPROVEMENTS.md`
  - [x] `OFFLINE_SYNC_PLAN.md`
  - [x] `OFFLINE_SYNC_NOTES.md`
  - [x] `OFFLINE_CACHE_NOTES.md`
  - [x] `OFFLINE_DAY_LOGIC_NOTES.md`
  - [x] `NOTES.md`
  - [x] `knowledge_base/sync_offline_notes.md`
- [x] Создать `archive/README.md` с описанием архива

### Этап 2: Обновление ссылок
- [x] Проверить все ссылки на перемещенные документы
- [x] Обновить ссылку в `OFFLINE_REQUIREMENTS.md`
- [x] Создать `docs/INDEX.md` с индексом документации

### Этап 3: Устранение дублирования
- [ ] Обновить документы для ссылок на канонические версии
- [ ] Удалить дублирующую информацию

### Этап 4: Устранение несоответствий
- [ ] Уточнить статус миграции LocalApi
- [ ] Проверить согласованность версий API
- [ ] Проверить согласованность описаний формата

### Этап 5: Создание индекса документации
- [x] Создать `docs/INDEX.md` с индексом всех актуальных документов
- [x] Описать структуру документации
- [x] Указать назначение каждого документа

## 7. Выводы

1. **Много устаревших документов:** Несколько планов и заметок содержат информацию, которая уже вынесена в актуальные документы
2. **Дублирование информации:** Правила фильтрации, архитектура и синхронизация описаны в нескольких местах
3. **Несоответствия:** Статус миграции LocalApi неясен, версии API могут быть несинхронизированы
4. **Необходимость реорганизации:** Требуется четкая структура документации с разделением на актуальные документы и архив

## 8. Приоритеты

**Высокий приоритет:**
- Переместить устаревшие планы и заметки в архив
- Устранить дублирование правил фильтрации
- Уточнить статус миграции LocalApi

**Средний приоритет:**
- Обновить ссылки на перемещенные документы
- Проверить согласованность версий API
- Создать индекс документации

**Низкий приоритет:**
- Реорганизация структуры папок
- Дополнительная категоризация документов
